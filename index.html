<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Game Arena</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #121212;
    color: white;
    margin: 0;
    padding: 0;
  }
  .container {
    max-width: 500px;
    margin: 30px auto;
    padding: 15px;
  }
  h1, h2 {
    text-align: center;
  }
  h1 {
    font-size: 20px;
    margin-bottom: 10px;
  }
  h2 {
    font-size: 18px;
    margin-bottom: 10px;
    color: #ccc;
    font-weight: bold;
  }
  input, button {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    margin: 6px 0;
    border-radius: 6px;
    border: none;
    box-sizing: border-box;
    background: #1e1e1e;
    color: white;
  }
  #teamname {
    font-weight: bold;
    text-transform: uppercase;
  }
  button {
    font-weight: bold;
    cursor: pointer;
  }
  button:disabled {
    background: #555;
    color: #aaa;
    cursor: not-allowed;
  }
  #continueBtn {
    background: gray;
    color: #ddd;
  }
  #continueBtn.enabled {
    background: gold;
    color: black;
  }
  #uploadBtn {
    background: gold;
    color: black;
  }
  #uploadBtn:hover {
    background: orange;
  }
  .hidden {
    display: none;
  }
  .g-recaptcha {
    margin: 10px 0;
  }
  .players input {
    padding: 12px 10px;
    font-size: 16px;
    margin: 4px 0;
    border-radius: 5px;
    width: 100%;
    box-sizing: border-box;
  }
  #paymentInfo {
    background: #2a2a2a;
    border-radius: 6px;
    padding: 12px;
    margin-top: 4px;
    font-size: 14px;
    line-height: 1.4;
    color: #ccc;
  }
  .copy-btn {
    display: inline-block;
    background: #444;
    color: #ddd;
    font-size: 12px;
    padding: 2px 8px;
    margin-left: 8px;
    border-radius: 4px;
    cursor: pointer;
    user-select: none;
    vertical-align: middle;
    transition: background-color 0.3s;
  }
  .copy-btn:hover {
    background: #666;
  }
  .custom-select {
    position: relative;
    user-select: none;
    margin: 12px 0;
  }
  .select-selected {
    background: #1e1e1e;
    padding: 12px;
    border-radius: 6px;
    cursor: pointer;
    color: white;
  }
  .select-selected:after {
    content: "\25BC";
    float: right;
    margin-left: 10px;
    color: #aaa;
  }
  .select-selected.select-arrow-active:after {
    content: "\25B2";
  }
  .select-items {
    position: absolute;
    background: #2a2a2a;
    top: 100%;
    left: 0;
    right: 0;
    z-index: 99;
    border-radius: 0 0 6px 6px;
    max-height: 150px;
    overflow-y: auto;
    display: none;
  }
  .select-items div {
    padding: 12px;
    cursor: pointer;
    color: white;
  }
  .select-items div:hover {
    background: #444;
  }
  /* Join Telegram Button */
  #joinTelegramBtn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    background: #229ED9;
    color: white;
    font-size: 16px;
    padding: 12px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    margin: 20px auto 10px;
    width: 80%;
    max-width: 300px;
    text-decoration: none;
  }
  #joinTelegramBtn:hover {
    background: #198ACA;
  }
  #joinTelegramBtn svg {
    width: 24px;
    height: 24px;
    fill: white;
  }
  /* Customer Service Button */
  #newServiceBtn {
    position: fixed;
    right: 20px;
    bottom: 20px;
    width: 56px;
    height: 56px;
    background: #e64a19;
    border-radius: 50%;
    box-shadow: 0 4px 12px rgba(230, 74, 25, 0.7);
    border: none;
    cursor: pointer;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1100;
    transition: background-color 0.3s ease;
  }
  #newServiceBtn:hover {
    background: #d84315;
  }
  #newServiceBtn svg {
    width: 28px;
    height: 28px;
    fill: white;
  }
  #newContactPopup {
    position: fixed;
    right: 20px;
    bottom: 80px;
    background: #222;
    border-radius: 8px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.8);
    padding: 15px;
    width: 200px;
    z-index: 1200;
    display: none;
    flex-direction: column;
    align-items: flex-start;
  }
  #newContactPopup.active {
    display: flex;
  }
  #newContactPopup a {
    color: white;
    padding: 8px 10px;
    text-decoration: none;
    font-weight: bold;
    display: flex;
    align-items: center;
    transition: background-color 0.3s;
    border-radius: 4px;
    margin-bottom: 5px;
    width: 100%;
    box-sizing: border-box;
  }
  #newContactPopup a:hover {
    background: #444;
  }
  #newContactPopup a svg {
    width: 20px;
    height: 20px;
    margin-right: 10px;
    fill: #0088cc;
    flex-shrink: 0;
  }
</style>
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>
<div class="container">
  <h1 id="groupTitle">Group A</h1>
  <form id="registrationForm" action="https://formspree.io/f/YOUR_FORMSPREE_ENDPOINT" method="POST">
    <div id="step1">
      <input type="text" id="teamname" name="teamname" placeholder="Enter team name" autocomplete="off" />
      <input type="text" id="tgUsername" name="tgUsername" placeholder="Enter telegram username" autocomplete="off" />
      <input type="text" id="mobile" name="mobile" placeholder="Enter mobile number" autocomplete="off" />
      <div class="custom-select" id="customPaymentSelect" tabindex="0" aria-haspopup="listbox" aria-expanded="false" role="combobox">
        <div class="select-selected" aria-live="polite" aria-label="Payment method selection">Select payment method</div>
        <div class="select-items" role="listbox" tabindex="-1">
          <div role="option" data-value="Bk" tabindex="0">Bkash</div>
          <div role="option" data-value="Ng" tabindex="0">Nagod</div>
        </div>
      </div>
      <div id="paymentInfo" class="hidden" aria-live="polite"></div>
      <input type="text" id="trxid" name="trxid" placeholder="Enter Transaction Id" autocomplete="off" />
      <button id="continueBtn" type="button" disabled>Continue</button>
    </div>
    <div id="step2" class="hidden">
      <div class="players">
        <input type="text" id="player1" name="player1" placeholder="Player 1 Name" autocomplete="off" />
        <input type="text" id="player2" name="player2" placeholder="Player 2 Name" autocomplete="off" />
        <input type="text" id="player3" name="player3" placeholder="Player 3 Name" autocomplete="off" />
        <input type="text" id="player4" name="player4" placeholder="Player 4 Name" autocomplete="off" />
        <input type="text" id="player5" name="player5" placeholder="Player 5 Name" autocomplete="off" />
      </div>
      <div class="g-recaptcha" data-sitekey="6LcAy58rAAAAABuoRRTaNeOHkbdo9NJUDiuqbq22"></div>
      <button id="uploadBtn" type="submit">Submit</button>
    </div>
  </form>
  <a id="joinTelegramBtn" href="https://t.me/Gamee_Arena" target="_blank" rel="noopener noreferrer">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
      <path fill="currentColor" d="M11.944 0a12 12 0 1 0 0 24a12 12 0 0 0 0-24zm5.623 8.653c-.115 1.488-.934 6.787-1.127 8.016-.16.994-.535 1.295-1.314.896-.764-.393-2.221-1.246-3.085-1.884-.962-.714-.305-1.025.26-1.592.176-.176 3.428-3.13 3.514-3.41-.019-.06-.039-.124-.059-.187-.33-.016-.71.127-2.316 1.258-1.082.78-1.84 1.32-2.887 2.083-.758.552-1.426.804-2.12.78-.71-.02-1.956-.37-2.695-.615-.81-.26-1.442-.4-1.41-1.05.02-.454.675-.684 1.832-1.122 5.372-2.022 7.15-2.699 8.18-3.093 2.148-.82 2.766-1.01 3.256-1.006.495.004.87.214 1.135.61.268.4.34 1.02.23 1.77z"/>
    </svg>
    Join Telegram
  </a>
</div>

<button id="newServiceBtn" aria-label="Contact customer service" title="Customer Service" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm-1-8.75c.69 0 1.25.56 1.25 1.25s-.56 1.25-1.25 1.25-1.25-.56-1.25-1.25.56-1.25 1.25-1.25z"/>
  </svg>
</button>

<div id="newContactPopup" role="menu" aria-hidden="true" aria-label="Customer service options">
  <a href="https://t.me/NeoEchoo" target="_blank" rel="noopener" role="menuitem" tabindex="0">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
      <path fill="currentColor" d="M11.944 0a12 12 0 1 0 0 24a12 12 0 0 0 0-24zm5.623 8.653c-.115 1.488-.934 6.787-1.127 8.016-.16.994-.535 1.295-1.314.896-.764-.393-2.221-1.246-3.085-1.884-.962-.714-.305-1.025.26-1.592.176-.176 3.428-3.13 3.514-3.41-.019-.06-.039-.124-.059-.187-.33-.016-.71.127-2.316 1.258-1.082.78-1.84 1.32-2.887 2.083-.758.552-1.426.804-2.12.78-.71-.02-1.956-.37-2.695-.615-.81-.26-1.442-.4-1.41-1.05.02-.454.675-.684 1.832-1.122 5.372-2.022 7.15-2.699 8.18-3.093 2.148-.82 2.766-1.01 3.256-1.006.495.004.87.214 1.135.61.268.4.34 1.02.23 1.77z"/>
    </svg>
    Helpline 1
  </a>
  <a href="https://t.me/Game_Arena_saport_admin" target="_blank" rel="noopener" role="menuitem" tabindex="0">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
      <path fill="currentColor" d="M11.944 0a12 12 0 1 0 0 24a12 12 0 0 0 0-24zm5.623 8.653c-.115 1.488-.934 6.787-1.127 8.016-.16.994-.535 1.295-1.314.896-.764-.393-2.221-1.246-3.085-1.884-.962-.714-.305-1.025.26-1.592.176-.176 3.428-3.13 3.514-3.41-.019-.06-.039-.124-.059-.187-.33-.016-.71.127-2.316 1.258-1.082.78-1.84 1.32-2.887 2.083-.758.552-1.426.804-2.12.78-.71-.02-1.956-.37-2.695-.615-.81-.26-1.442-.4-1.41-1.05.02-.454.675-.684 1.832-1.122 5.372-2.022 7.15-2.699 8.18-3.093 2.148-.82 2.766-1.01 3.256-1.006.495.004.87.214 1.135.61.268.4.34 1.02.23 1.77z"/>
    </svg>
    Helpline 2
  </a>
</div>
<script>
  // Dropdown select logic
  const customSelect = document.getElementById('customPaymentSelect');
  const selected = customSelect.querySelector('.select-selected');
  const optionsContainer = customSelect.querySelector('.select-items');
  let selectedPaymentValue = '';

  const paymentTexts = {
    Bk: `Bkash Send Money<br><span id="paymentNumber">01798290256</span><span class="copy-btn" id="copyBtn" title="Click to copy">copy</span><br>Then enter the Trxid above`,
    Ng: `Nagad Send Money<br><span id="paymentNumber">9856001060189572</span><span class="copy-btn" id="copyBtn" title="Click to copy">copy</span><br>Then enter the Trxid above`
  };

  selected.addEventListener('click', () => {
    const expanded = customSelect.getAttribute('aria-expanded') === 'true';
    if (expanded) {
      optionsContainer.style.display = 'none';
      customSelect.setAttribute('aria-expanded', 'false');
      selected.classList.remove('select-arrow-active');
    } else {
      optionsContainer.style.display = 'block';
      customSelect.setAttribute('aria-expanded', 'true');
      selected.classList.add('select-arrow-active');
    }
  });

  optionsContainer.querySelectorAll('div').forEach(option => {
    option.addEventListener('click', () => {
      selected.textContent = option.textContent;
      selectedPaymentValue = option.getAttribute('data-value');
      selected.setAttribute('data-value', selectedPaymentValue);
      // Added a hidden input to send the payment method value to Formspree
      let paymentMethodInput = document.getElementById('paymentMethod');
      if (!paymentMethodInput) {
          paymentMethodInput = document.createElement('input');
          paymentMethodInput.type = 'hidden';
          paymentMethodInput.id = 'paymentMethod';
          paymentMethodInput.name = 'paymentMethod';
          document.getElementById('step1').appendChild(paymentMethodInput);
      }
      paymentMethodInput.value = option.textContent;

      optionsContainer.style.display = 'none';
      customSelect.setAttribute('aria-expanded', 'false');
      selected.classList.remove('select-arrow-active');
      validateStep1();
      updatePaymentInfo(selectedPaymentValue);
    });
  });

  document.addEventListener('click', (e) => {
    if (!customSelect.contains(e.target)) {
      optionsContainer.style.display = 'none';
      customSelect.setAttribute('aria-expanded', 'false');
      selected.classList.remove('select-arrow-active');
    }
  });

  function updatePaymentInfo(val) {
    if(paymentTexts.hasOwnProperty(val)) {
      paymentInfo.innerHTML = paymentTexts[val];
      paymentInfo.classList.remove('hidden');

      const copyBtn = document.getElementById('copyBtn');
      const paymentNumber = document.getElementById('paymentNumber');

      if(copyBtn && paymentNumber) {
        copyBtn.onclick = () => {
          const textToCopy = paymentNumber.textContent;
          navigator.clipboard.writeText(textToCopy).then(() => {
            alert(`Copied: ${textToCopy}`);
          }).catch(() => {
            alert('Copy failed. Please copy manually.');
          });
        };
      }
    } else {
      paymentInfo.innerHTML = '';
      paymentInfo.classList.add('hidden');
    }
  }

  const teamname = document.getElementById('teamname');
  const tgUsername = document.getElementById('tgUsername');
  const mobile = document.getElementById('mobile');
  const trxid = document.getElementById('trxid');
  const paymentInfo = document.getElementById('paymentInfo');
  const continueBtn = document.getElementById('continueBtn');
  const uploadBtn = document.getElementById('uploadBtn');
  const step1 = document.getElementById('step1');
  const step2 = document.getElementById('step2');
  const groupTitle = document.getElementById('groupTitle');
  
  // Get the form element
  const registrationForm = document.getElementById('registrationForm');

  function validateTeamName(name) {
    const upperName = name.toUpperCase();
    const regex = /^[A-Z0-9 \-']+$/;
    return regex.test(upperName);
  }

  function validateStep1() {
    const teamNameValue = teamname.value.trim();
    const isTeamNameValid = validateTeamName(teamNameValue);
    if (
      teamNameValue !== '' &&
      isTeamNameValid &&
      tgUsername.value.trim() !== '' &&
      mobile.value.trim() !== '' &&
      trxid.value.trim() !== '' &&
      selectedPaymentValue !== ''
    ) {
      continueBtn.disabled = false;
      continueBtn.classList.add('enabled');
    } else {
      continueBtn.disabled = true;
      continueBtn.classList.remove('enabled');
    }
  }

  teamname.addEventListener('input', () => {
    let val = teamname.value.toUpperCase();
    val = val.replace(/[^A-Z0-9 \-']/g, '');
    teamname.value = val;
    validateStep1();
  });

  [tgUsername, mobile, trxid].forEach(el => {
    el.addEventListener('input', validateStep1);
  });

  continueBtn.addEventListener('click', () => {
    if (continueBtn.disabled) {
      alert("Please fill all required fields correctly.");
      return;
    }
    groupTitle.textContent = "Players name";
    step1.classList.add('hidden');
    step2.classList.remove('hidden');
  });

  const newServiceBtn = document.getElementById('newServiceBtn');
  const newContactPopup = document.getElementById('newContactPopup');

  newServiceBtn.addEventListener('click', () => {
    const isActive = newContactPopup.classList.contains('active');
    if (isActive) {
      newContactPopup.classList.remove('active');
      newContactPopup.setAttribute('aria-hidden', 'true');
    } else {
      newContactPopup.classList.add('active');
      newContactPopup.setAttribute('aria-hidden', 'false');
    }
  });

  document.addEventListener('click', (e) => {
    if (!newContactPopup.contains(e.target) && !newServiceBtn.contains(e.target)) {
      newContactPopup.classList.remove('active');
      newContactPopup.setAttribute('aria-hidden', 'true');
    }
  });

  newContactPopup.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      newContactPopup.classList.remove('active');
      newContactPopup.setAttribute('aria-hidden', 'true');
    });
  });
  
  // This is the new part for Formspree submission
  registrationForm.addEventListener('submit', async (e) => {
    e.preventDefault(); // Stop the default form submission
    
    // Disable the button to prevent double-clicks
    uploadBtn.disabled = true;
    
    // Get all form data
    const formData = new FormData(registrationForm);
    
    try {
      const response = await fetch(registrationForm.action, {
        method: 'POST',
        body: formData,
        headers: {
          'Accept': 'application/json'
        }
      });
      
      if (response.ok) {
        alert("Registration successful! We have received your details.");
        registrationForm.reset(); // Clear the form
        // You might want to redirect the user or display a success message
      } else {
        const data = await response.json();
        if (data.errors) {
          alert(`Submission failed: ${data.errors.map(err => err.message).join(', ')}`);
        } else {
          alert("Oops! There was a problem with your submission.");
        }
      }
    } catch (error) {
      alert("An error occurred. Please try again.");
    } finally {
      // Re-enable the button
      uploadBtn.disabled = false;
    }
  });
</script>
</body>
</html>